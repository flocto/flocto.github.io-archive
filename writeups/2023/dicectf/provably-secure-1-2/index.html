<!doctype html><html lang=en-us><head><title>Provably Secure 1 and 2 | flocto</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.115.4"><link rel=canonical href=/writeups/2023/dicectf/provably-secure-1-2/><link href=/sass/main.min.c404f77850d7537fd75fd672eccb9290723f3f99d3b00709b78a731d5969ada8.css rel=stylesheet></head><body><div class=flexWrapper><header class=headerWrapper><div class=header><div><a href=/><span class=terminal>fl@cto ~ $</span></a></div><nav class=headerLinks><ul><li><a href=/about title>~/about</a></li><li><a href=/projects title>~/projects</a></li><li><a href=/writeups title>~/writeups</a></li><li><a href=/blog title>~/blog</a></li><li><a href=/ style=align-items:center;justify-content:center><img style=width:30px;height:30px;border-radius:15px;vertical-align:text-bottom src=/profile.png alt=Home></a></li></ul></nav></div></header><div class=content><main class=main><div class=postWrapper><h1>Provably Secure 1 and 2</h1><ul class=tagList><li class=tagItem><a class=tagLink href=/tags/crypto/>crypto</a></li><li class=tagItem><a class=tagLink href=/tags/dicectf/>dicectf</a></li><li class=tagItem><a class=tagLink href=/tags/2023/>2023</a></li></ul><div><p>Wanted to try out something different, so I decided to use Motion Canvas to try and make a video writeup for the 2 easy crypto challs&mldr;</p><p>Only to end up spending 2 weeks to make a 5 minute video with no audio lol.</p><p>Here&rsquo;s a short text writeup for the both of them:</p><h2 id=provably-secure-1>Provably Secure 1</h2><p>Server doesn&rsquo;t properly handle checking already encrypted ciphertext, so we can literally just treat it like an encryption/decryption oracle.</p><p>We have to guess <code>m_bit</code> 128 times depending on which message is encrypted, so just using two unique messages is fine.
Shortcut: use <code>0</code> and <code>1</code> so we can just cast to int and directly send it to the server.</p><div class=highlight><div style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">29
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#c678dd>from</span> <span style=color:#76a9f9>pwn</span> <span style=color:#c678dd>import</span> <span style=color:#c7bf54>*</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>from</span> <span style=color:#76a9f9>tqdm</span> <span style=color:#c678dd>import</span> <span style=color:#c1abea>tqdm</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># nc mc.ax 31493</span>
</span></span><span style=display:flex><span><span style=color:#c1abea>r</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>remote</span>(<span style=color:#98c379>&#39;mc.ax&#39;</span>, <span style=color:#d19a66>31493</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>for</span> <span style=color:#c1abea>i</span> <span style=color:#b756ff;font-weight:700>in</span> <span style=color:#c1abea>tqdm</span>(<span style=color:#ef8383>range</span>(<span style=color:#d19a66>128</span>)):
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;Action:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;1&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;m0 (16 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;0&#39;</span><span style=color:#c7bf54>*</span><span style=color:#d19a66>32</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;m1 (16 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;0&#39;</span><span style=color:#c7bf54>*</span><span style=color:#d19a66>31</span> <span style=color:#c7bf54>+</span> <span style=color:#98c379>b</span><span style=color:#98c379>&#39;1&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>ct</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvline</span>()<span style=color:#c7bf54>.</span><span style=color:#c1abea>strip</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;Action:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;2&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;ct (512 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#c1abea>ct</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>m</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvline</span>()<span style=color:#c7bf54>.</span><span style=color:#c1abea>strip</span>()
</span></span><span style=display:flex><span>    <span style=color:#c1abea>m</span> <span style=color:#c7bf54>=</span> <span style=color:#ef8383>int</span>(<span style=color:#c1abea>m</span>) <span style=color:#8a93a5;font-style:italic># 0 or 1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;Action:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;0&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;m_bit guess:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#ef8383>str</span>(<span style=color:#c1abea>m</span>)<span style=color:#c7bf54>.</span><span style=color:#c1abea>encode</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>interactive</span>()
</span></span></code></pre></td></tr></table></div></div><h2 id=provably-secure-2>Provably Secure 2</h2><h4 id=actual-exploitation-of-encryption-scheme-but-same-setup-just-with-fatal-bug-fixed>Actual exploitation of encryption scheme, but same setup, just with fatal bug fixed.</h4><p>There is two keys, so we can split scheme into two seperate functions that occur on the same pair.
Treat encryption and decryption as black box functions: (<code>r</code> is random bytes, <code>m_b</code> is chosen message)
$$
\begin{align}
E(m_1, m_2) &=& E_1(r), E_2(r \oplus m_b) \newline
D(c_1, c_2) &=& D_1(c_1) \oplus D_2(c_2)
\end{align}
$$</p><p>$$
\begin{align}
D_1(E_1(x)) = x \newline
D_2(E_2(x)) = x
\end{align}
$$
We have free control over <code>m_1</code>, <code>m_2</code> for encryption, and <code>c_1</code>, <code>c_2</code> for decryption.</p><p>However, we don&rsquo;t know <code>r</code>.</p><p>But consider the following construction where we swap ciphertext pairs:
(apologies for spaghetti but hopefully you get the idea)
$$
\begin{align}
E_1(r_1), E_2(r_1 \oplus m_{b1}) = E(m_1, m_2) \newline
E_1(r_2), E_2(r_2 \oplus m_{b2}) = E(m_1, m_2)
\end{align}
$$</p><p>$$
D(E_1(r_1), E_2(r_2 \oplus m_{b2}))
= D_1(E_1(r_1)) \oplus D_2(E_2(r_2 \oplus m_{b2}))
= r_1 \oplus (r_2 \oplus m_{b2})
= r_1 \oplus r_2 \oplus m_{b2}
$$</p><p>$$
D(E_1(r_2), E_2(r_1 \oplus m_{b1}))
= D_1(E_1(r_2)) \oplus D_2(E_2(r_1 \oplus m_{b1}))
= r_2 \oplus (r_1 \oplus m_{b1})
= r_1 \oplus r_2 \oplus m_{b1}
$$</p><p>Notice that if <code>m_b1</code> and <code>m_b2</code> are the same, then <code>r_1 \oplus r_2 \oplus m_b1</code> is the same as <code>r_1 \oplus r_2 \oplus m_b2</code>.</p><p>So all we have to do is vary one message, and recover <code>m_bit</code> based on whether the swapped decryption changes or not.</p><div class=highlight><div style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#58626f">48
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#c678dd>from</span> <span style=color:#76a9f9>pwn</span> <span style=color:#c678dd>import</span> <span style=color:#c7bf54>*</span>
</span></span><span style=display:flex><span><span style=color:#c678dd>from</span> <span style=color:#76a9f9>tqdm</span> <span style=color:#c678dd>import</span> <span style=color:#c1abea>tqdm</span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># nc mc.ax 31497</span>
</span></span><span style=display:flex><span><span style=color:#c1abea>r</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>remote</span>(<span style=color:#98c379>&#39;mc.ax&#39;</span>, <span style=color:#d19a66>31497</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c678dd>for</span> <span style=color:#c1abea>i</span> <span style=color:#b756ff;font-weight:700>in</span> <span style=color:#c1abea>tqdm</span>(<span style=color:#ef8383>range</span>(<span style=color:#d19a66>128</span>)):
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;Action:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;1&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;m0 (16 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;0&#39;</span><span style=color:#c7bf54>*</span><span style=color:#d19a66>32</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;m1 (16 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;0&#39;</span><span style=color:#c7bf54>*</span><span style=color:#d19a66>31</span> <span style=color:#c7bf54>+</span> <span style=color:#98c379>b</span><span style=color:#98c379>&#39;1&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>ct1</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvline</span>()<span style=color:#c7bf54>.</span><span style=color:#c1abea>strip</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;Action:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;1&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;m0 (16 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;0&#39;</span><span style=color:#c7bf54>*</span><span style=color:#d19a66>32</span> )
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;m1 (16 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;0&#39;</span><span style=color:#c7bf54>*</span><span style=color:#d19a66>31</span> <span style=color:#c7bf54>+</span> <span style=color:#98c379>b</span><span style=color:#98c379>&#39;2&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>ct2</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvline</span>()<span style=color:#c7bf54>.</span><span style=color:#c1abea>strip</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>dt1</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>ct1</span>[:<span style=color:#d19a66>512</span>] <span style=color:#c7bf54>+</span> <span style=color:#c1abea>ct2</span>[<span style=color:#d19a66>512</span>:]
</span></span><span style=display:flex><span>    <span style=color:#c1abea>dt2</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>ct2</span>[:<span style=color:#d19a66>512</span>] <span style=color:#c7bf54>+</span> <span style=color:#c1abea>ct1</span>[<span style=color:#d19a66>512</span>:]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;Action:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;2&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;ct (512 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#c1abea>dt1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>m1</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvline</span>()<span style=color:#c7bf54>.</span><span style=color:#c1abea>strip</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;Action:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;2&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;ct (512 byte hexstring):&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#c1abea>dt2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>m2</span> <span style=color:#c7bf54>=</span> <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvline</span>()<span style=color:#c7bf54>.</span><span style=color:#c1abea>strip</span>()
</span></span><span style=display:flex><span>    <span style=color:#c1abea>m</span> <span style=color:#c7bf54>=</span> <span style=color:#ef8383>int</span>(<span style=color:#c1abea>m1</span> <span style=color:#c7bf54>!=</span> <span style=color:#c1abea>m2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;Action:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;0&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>recvuntil</span>(<span style=color:#98c379>b</span><span style=color:#98c379>&#39;m_bit guess:&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>sendline</span>(<span style=color:#ef8383>str</span>(<span style=color:#c1abea>m</span>)<span style=color:#c7bf54>.</span><span style=color:#c1abea>encode</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#c1abea>r</span><span style=color:#c7bf54>.</span><span style=color:#c1abea>interactive</span>()
</span></span></code></pre></td></tr></table></div></div><h2 id=video>Video</h2><p>Here&rsquo;s the <a href="https://www.youtube.com/watch?v=vAcX--GornA&amp;ab_channel=flocto">video</a> if you want to watch it, but its basically the same as above with cooler visuals.</p></div></div></main></div><script>function handle_open(e){let t=e.target;e.target.tagName==="SUMMARY"&&(t=e.target.querySelector(".code-summary-inner")),t.classList.toggle("open"),t.classList.contains("open")?t.textContent="Click to collapse "+t.textContent.split(" ").slice(3).join(" "):t.textContent="Click to expand "+t.textContent.split(" ").slice(3).join(" ")}let code_divs=document.querySelectorAll("div.highlight"),to_remove=[];for(let e of code_divs){let t="",n=e.previousElementSibling;n.tagName=="P"&&(n=n.textContent,n.startsWith("filename")&&(t=n.split("=")[1].trim(),to_remove.push(e.previousElementSibling)));let s=e.querySelector("pre code"),o=s.textContent.split(`
`).length;if(t!==""||o>10){let n=document.createElement("details"),o=document.createElement("summary"),i=document.createElement("span");i.textContent="Click to expand",t!==""&&(i.textContent+=" "+t,n.setAttribute("id",t)),i.classList.add("code-summary-inner"),o.appendChild(i),o.addEventListener("click",handle_open),o.classList.add("code-summary"),s.classList.add("code-inner"),e.parentNode.insertBefore(n,e),n.appendChild(o),n.appendChild(e),n.classList.add("code-wrapper")}}for(let e of to_remove)e.remove();let anchors=document.querySelectorAll(".postWrapper a");for(let e of anchors)e.host!==window.location.host&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"));let headers=document.querySelectorAll(".postWrapper div h1, .postWrapper div h2, .postWrapper div h3, .postWrapper div h4, .postWrappe div h5, .postWrapper div h6");for(let t of headers){let n=t.getAttribute("id"),e=document.createElement("a");e.setAttribute("href","#"+n),e.classList.add("header-link"),e.textContent="#",t.append(e)}</script><footer class=footer>© 2023 flocto, Built with
<a href=https://gohugo.io class=footerLink>Hugo</a> and (an edited)
<a href=https://github.com/LordMathis/hugo-theme-nightfall class=footerLink>Nightfall</a> theme</footer><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></div></body></html>